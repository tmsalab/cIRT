<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Simulation Study with cIRT â€¢ cIRT</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Simulation Study with cIRT">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-151562227-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-151562227-1');
</script>
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cIRT</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.3.0.900</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Estimating-the-Model-in-the-Paper.html">Estimating the Model in the Paper</a>
    </li>
    <li>
      <a href="../articles/Package-Overview.html">Package Overview</a>
    </li>
    <li>
      <a href="../articles/Simulation-Study-with-cIRT.html">Simulation Study with cIRT</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/tmsalab/cIRT">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Simulation Study with cIRT</h1>
            
            <h4 class="date">2019-11-06</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/tmsalab/cIRT/blob/master/vignettes/Simulation-Study-with-cIRT.Rmd"><code>vignettes/Simulation-Study-with-cIRT.Rmd</code></a></small>
      <div class="hidden name"><code>Simulation-Study-with-cIRT.Rmd</code></div>

    </div>

    
    
<div id="intro" class="section level1">
<h1 class="hasAnchor">
<a href="#intro" class="anchor"></a>Intro</h1>
<p>The document addresses the simulation study that was performed to understand whether <code>cIRT</code> was able to effectively recover parameters under the proposed model. There are three sections to this document. The first section details the simulation setup and implementation. The second section deals with how we obtained overall measurements for each model realization. The third and final section depicts the output structure we used to create the tables within the publication.</p>
</div>
<div id="simulation" class="section level1">
<h1 class="hasAnchor">
<a href="#simulation" class="anchor"></a>Simulation</h1>
<p>The simulation study below is configured to generate results one might obtain from a pool of 1,000 subjects taking a 20 item test. We obtain summarize the results obtained from running the model 100 times over slightly differring <span class="math inline">\(\theta\)</span> and <span class="math inline">\(\eta\)</span>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">### Variables</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="co"># Y = trial matix</span></a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="co"># C = KN vector of binary choices</span></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="co"># N = #of subjects</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="co"># J = # of items</span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="co"># K = # of choices</span></a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="co"># atrue = true item discriminations</span></a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="co"># btrue = true item locations</span></a>
<a class="sourceLine" id="cb1-9" data-line-number="9"><span class="co"># thetatrue = true thetas/latent performance</span></a>
<a class="sourceLine" id="cb1-10" data-line-number="10"><span class="co"># gamma = fixed effects coefficients</span></a>
<a class="sourceLine" id="cb1-11" data-line-number="11"><span class="co"># Sig = random-effects variance-covariance</span></a>
<a class="sourceLine" id="cb1-12" data-line-number="12"><span class="co"># subid = id variable for subjects</span></a>
<a class="sourceLine" id="cb1-13" data-line-number="13"></a>
<a class="sourceLine" id="cb1-14" data-line-number="14"><span class="co"># install mvtnorm is necessary</span></a>
<a class="sourceLine" id="cb1-15" data-line-number="15"><span class="co"># install.packages("mvtnorm")</span></a>
<a class="sourceLine" id="cb1-16" data-line-number="16"></a>
<a class="sourceLine" id="cb1-17" data-line-number="17"><span class="co"># Load the Library</span></a>
<a class="sourceLine" id="cb1-18" data-line-number="18"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(cIRT)</a>
<a class="sourceLine" id="cb1-19" data-line-number="19"></a>
<a class="sourceLine" id="cb1-20" data-line-number="20"><span class="co"># Simulate 2PNO Data</span></a>
<a class="sourceLine" id="cb1-21" data-line-number="21">N =<span class="st"> </span><span class="dv">1000</span>  <span class="co"># Students</span></a>
<a class="sourceLine" id="cb1-22" data-line-number="22">J =<span class="st"> </span><span class="dv">20</span>    <span class="co"># Total numbers of possible items per SA</span></a>
<a class="sourceLine" id="cb1-23" data-line-number="23"></a>
<a class="sourceLine" id="cb1-24" data-line-number="24"><span class="co"># Set a seed for the random generation of a's and b's.</span></a>
<a class="sourceLine" id="cb1-25" data-line-number="25"><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">1337</span>)</a>
<a class="sourceLine" id="cb1-26" data-line-number="26"></a>
<a class="sourceLine" id="cb1-27" data-line-number="27"><span class="co"># Randomly pick a's and b's</span></a>
<a class="sourceLine" id="cb1-28" data-line-number="28"></a>
<a class="sourceLine" id="cb1-29" data-line-number="29"><span class="co"># Generate as, bs</span></a>
<a class="sourceLine" id="cb1-30" data-line-number="30">atrue=<span class="kw"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span>(J)<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb1-31" data-line-number="31">btrue=<span class="dv">2</span><span class="op">*</span><span class="kw"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span>(J)<span class="op">-</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb1-32" data-line-number="32"></a>
<a class="sourceLine" id="cb1-33" data-line-number="33"><span class="kw"><a href="https://rdrr.io/r/base/save.html">save</a></span>(atrue, btrue, <span class="dt">file=</span><span class="st">"a_b_true.rda"</span>)</a>
<a class="sourceLine" id="cb1-34" data-line-number="34"></a>
<a class="sourceLine" id="cb1-35" data-line-number="35"></a>
<a class="sourceLine" id="cb1-36" data-line-number="36"><span class="co"># 2 Level Probit Data</span></a>
<a class="sourceLine" id="cb1-37" data-line-number="37">K =<span class="st"> </span><span class="dv">30</span></a>
<a class="sourceLine" id="cb1-38" data-line-number="38"></a>
<a class="sourceLine" id="cb1-39" data-line-number="39">gam_notheta =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(.<span class="dv">5</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb1-40" data-line-number="40">gam_theta   =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">3</span>,.<span class="dv">25</span>)</a>
<a class="sourceLine" id="cb1-41" data-line-number="41">gamma =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(gam_notheta,gam_theta)</a>
<a class="sourceLine" id="cb1-42" data-line-number="42"></a>
<a class="sourceLine" id="cb1-43" data-line-number="43">Sig =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(.<span class="dv">25</span>,<span class="dv">0</span>,<span class="dv">0</span>,.<span class="dv">125</span>),<span class="dv">2</span>,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1-44" data-line-number="44"></a>
<a class="sourceLine" id="cb1-45" data-line-number="45"><span class="co"># Number of replications</span></a>
<a class="sourceLine" id="cb1-46" data-line-number="46">B =<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb1-47" data-line-number="47"></a>
<a class="sourceLine" id="cb1-48" data-line-number="48"><span class="co"># Begin the Simulation Study</span></a>
<a class="sourceLine" id="cb1-49" data-line-number="49"><span class="cf">for</span>(b <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>B){</a>
<a class="sourceLine" id="cb1-50" data-line-number="50">  </a>
<a class="sourceLine" id="cb1-51" data-line-number="51">  <span class="co"># Provide user with state information</span></a>
<a class="sourceLine" id="cb1-52" data-line-number="52">  <span class="kw"><a href="https://rdrr.io/r/base/cat.html">cat</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"On Iteration:"</span>,b,<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>))</a>
<a class="sourceLine" id="cb1-53" data-line-number="53">  <span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(b <span class="op">+</span><span class="st"> </span><span class="dv">1234</span>)</a>
<a class="sourceLine" id="cb1-54" data-line-number="54">  </a>
<a class="sourceLine" id="cb1-55" data-line-number="55">  <span class="co"># True theta and etay</span></a>
<a class="sourceLine" id="cb1-56" data-line-number="56">  thetatrue =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(N)</a>
<a class="sourceLine" id="cb1-57" data-line-number="57">  etay =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/outer.html">outer</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="dv">1</span>,N),atrue) <span class="op">*</span><span class="st"> </span>thetatrue <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/outer.html">outer</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="dv">1</span>,N),btrue)</a>
<a class="sourceLine" id="cb1-58" data-line-number="58">  </a>
<a class="sourceLine" id="cb1-59" data-line-number="59">  <span class="co"># Generate Y for 2PNO model</span></a>
<a class="sourceLine" id="cb1-60" data-line-number="60">  p.correct =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span>(etay)</a>
<a class="sourceLine" id="cb1-61" data-line-number="61">  Y =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span>(N<span class="op">*</span>J, <span class="dv">1</span>, p.correct),N,J)</a>
<a class="sourceLine" id="cb1-62" data-line-number="62">  </a>
<a class="sourceLine" id="cb1-63" data-line-number="63">  #################################################</a>
<a class="sourceLine" id="cb1-64" data-line-number="64">  <span class="co"># Simulating 2 level probit data</span></a>
<a class="sourceLine" id="cb1-65" data-line-number="65">  #################################################</a>
<a class="sourceLine" id="cb1-66" data-line-number="66">  </a>
<a class="sourceLine" id="cb1-67" data-line-number="67">  subid =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/expand.grid.html">expand.grid</a></span>(<span class="dt">cid =</span> <span class="dv">1</span><span class="op">:</span>K,<span class="dt">sid =</span> <span class="dv">1</span><span class="op">:</span>N)[,<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb1-68" data-line-number="68">  </a>
<a class="sourceLine" id="cb1-69" data-line-number="69">  pred =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(K<span class="op">*</span>N,<span class="dv">0</span>,<span class="dv">1</span>) <span class="co"># Pred</span></a>
<a class="sourceLine" id="cb1-70" data-line-number="70">  </a>
<a class="sourceLine" id="cb1-71" data-line-number="71">  center_pred =<span class="st"> </span><span class="kw"><a href="../reference/center_matrix.html">center_matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span>(pred))</a>
<a class="sourceLine" id="cb1-72" data-line-number="72">  </a>
<a class="sourceLine" id="cb1-73" data-line-number="73">  Xnotheta =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="dv">1</span>,center_pred)</a>
<a class="sourceLine" id="cb1-74" data-line-number="74">  </a>
<a class="sourceLine" id="cb1-75" data-line-number="75">  Xtheta =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(thetatrue,<span class="dt">each=</span>K)<span class="op">*</span>Xnotheta</a>
<a class="sourceLine" id="cb1-76" data-line-number="76">  X =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(Xnotheta,Xtheta)</a>
<a class="sourceLine" id="cb1-77" data-line-number="77">  </a>
<a class="sourceLine" id="cb1-78" data-line-number="78">  </a>
<a class="sourceLine" id="cb1-79" data-line-number="79">  zetas =<span class="st"> </span>mvtnorm<span class="op">::</span><span class="kw">rmvnorm</span>(N,<span class="dt">mean=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">0</span>,<span class="dv">0</span>),<span class="dt">sigma=</span>Sig) <span class="co"># mvtnorm environment accessed</span></a>
<a class="sourceLine" id="cb1-80" data-line-number="80">  W_veczeta =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/apply.html">apply</a></span>(Xnotheta<span class="op">*</span>zetas[<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="dv">1</span><span class="op">:</span>N,<span class="dt">each=</span>K),],<span class="dv">1</span>,sum)</a>
<a class="sourceLine" id="cb1-81" data-line-number="81">  </a>
<a class="sourceLine" id="cb1-82" data-line-number="82">  etac =<span class="st"> </span>X<span class="op">%*%</span>gamma <span class="op">+</span><span class="st"> </span>W_veczeta</a>
<a class="sourceLine" id="cb1-83" data-line-number="83">  Zc =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(N<span class="op">*</span>K,<span class="dt">mean=</span>etac,<span class="dt">sd=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb1-84" data-line-number="84">  C =<span class="st"> </span><span class="dv">1</span><span class="op">*</span>(Zc<span class="op">&gt;</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb1-85" data-line-number="85">  </a>
<a class="sourceLine" id="cb1-86" data-line-number="86">  <span class="co"># Run the Choice Item Response Model</span></a>
<a class="sourceLine" id="cb1-87" data-line-number="87">  out1 =<span class="st"> </span><span class="kw"><a href="../reference/cIRT.html">cIRT</a></span>(subid, </a>
<a class="sourceLine" id="cb1-88" data-line-number="88">              Xnotheta,</a>
<a class="sourceLine" id="cb1-89" data-line-number="89">              <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>,<span class="dv">2</span>), </a>
<a class="sourceLine" id="cb1-90" data-line-number="90">              Xnotheta,</a>
<a class="sourceLine" id="cb1-91" data-line-number="91">              Y, </a>
<a class="sourceLine" id="cb1-92" data-line-number="92">              C, </a>
<a class="sourceLine" id="cb1-93" data-line-number="93">              <span class="dv">5000</span>)</a>
<a class="sourceLine" id="cb1-94" data-line-number="94">  </a>
<a class="sourceLine" id="cb1-95" data-line-number="95">  mname =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"model_"</span>,b)</a>
<a class="sourceLine" id="cb1-96" data-line-number="96">  </a>
<a class="sourceLine" id="cb1-97" data-line-number="97">  <span class="co"># Assign the data set name</span></a>
<a class="sourceLine" id="cb1-98" data-line-number="98">  <span class="kw"><a href="https://rdrr.io/r/base/assign.html">assign</a></span>(mname, out1)</a>
<a class="sourceLine" id="cb1-99" data-line-number="99"></a>
<a class="sourceLine" id="cb1-100" data-line-number="100">  <span class="co"># Save the out object</span></a>
<a class="sourceLine" id="cb1-101" data-line-number="101">  <span class="kw"><a href="https://rdrr.io/r/base/save.html">save</a></span>(<span class="dt">list=</span>mname, <span class="dt">file=</span><span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(mname,<span class="st">".rda"</span>))</a>
<a class="sourceLine" id="cb1-102" data-line-number="102">  </a>
<a class="sourceLine" id="cb1-103" data-line-number="103">  <span class="co"># Clean up Export</span></a>
<a class="sourceLine" id="cb1-104" data-line-number="104">  <span class="kw"><a href="https://rdrr.io/r/base/rm.html">rm</a></span>(<span class="dt">list =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(mname,<span class="st">"out1"</span>))</a>
<a class="sourceLine" id="cb1-105" data-line-number="105">}</a></code></pre></div>
</div>
<div id="simulation-results" class="section level1">
<h1 class="hasAnchor">
<a href="#simulation-results" class="anchor"></a>Simulation Results</h1>
<p>After we obtain the 100 different models, we will need to take averages over each models chain and then obtain an overall average. To do so, we used the following script:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co"># E[theta] - theta </span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2">bias =<span class="st"> </span><span class="cf">function</span>(theta.star, theta.true){</a>
<a class="sourceLine" id="cb2-3" data-line-number="3">  <span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(theta.star) <span class="op">-</span><span class="st"> </span>theta.true,<span class="dt">ncol=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb2-4" data-line-number="4">}</a>
<a class="sourceLine" id="cb2-5" data-line-number="5"></a>
<a class="sourceLine" id="cb2-6" data-line-number="6">bias2 =<span class="st"> </span><span class="cf">function</span>(theta.star, theta.true){</a>
<a class="sourceLine" id="cb2-7" data-line-number="7">  <span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(theta.star <span class="op">-</span><span class="st"> </span>theta.true,<span class="dt">ncol=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb2-8" data-line-number="8">}</a>
<a class="sourceLine" id="cb2-9" data-line-number="9"></a>
<a class="sourceLine" id="cb2-10" data-line-number="10"><span class="co"># sqrt ( 1/n * sum( (y_i - y.hat_i)^2 )</span></a>
<a class="sourceLine" id="cb2-11" data-line-number="11">RMSE =<span class="st"> </span><span class="cf">function</span>(y,y.hat){</a>
<a class="sourceLine" id="cb2-12" data-line-number="12">  <span class="kw"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(  (y<span class="op">-</span>y.hat)<span class="op">^</span><span class="dv">2</span> ) </a>
<a class="sourceLine" id="cb2-13" data-line-number="13">}</a>
<a class="sourceLine" id="cb2-14" data-line-number="14"></a>
<a class="sourceLine" id="cb2-15" data-line-number="15"><span class="co"># Change true values if needed</span></a>
<a class="sourceLine" id="cb2-16" data-line-number="16"><span class="co"># True Values</span></a>
<a class="sourceLine" id="cb2-17" data-line-number="17">gam_notheta =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(.<span class="dv">5</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb2-18" data-line-number="18">gam_theta   =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">3</span>,.<span class="dv">25</span>)</a>
<a class="sourceLine" id="cb2-19" data-line-number="19">gamma =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(gam_notheta,gam_theta)</a>
<a class="sourceLine" id="cb2-20" data-line-number="20"><span class="co"># Loads a and b values</span></a>
<a class="sourceLine" id="cb2-21" data-line-number="21"><span class="kw"><a href="https://rdrr.io/r/base/load.html">load</a></span>(<span class="st">"a_b_true.rda"</span>)</a>
<a class="sourceLine" id="cb2-22" data-line-number="22"></a>
<a class="sourceLine" id="cb2-23" data-line-number="23">Sig =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(.<span class="dv">25</span>,<span class="dv">0</span>,<span class="dv">0</span>,.<span class="dv">125</span>),<span class="dv">2</span>,<span class="dv">2</span>))[<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>)]</a>
<a class="sourceLine" id="cb2-24" data-line-number="24">B =<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb2-25" data-line-number="25"></a>
<a class="sourceLine" id="cb2-26" data-line-number="26"><span class="co"># Storage to hold bootstrap replications</span></a>
<a class="sourceLine" id="cb2-27" data-line-number="27">a_result =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="dv">0</span>, B, <span class="dv">20</span>)</a>
<a class="sourceLine" id="cb2-28" data-line-number="28"></a>
<a class="sourceLine" id="cb2-29" data-line-number="29">b_result =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="dv">0</span>, B, <span class="dv">20</span>)</a>
<a class="sourceLine" id="cb2-30" data-line-number="30"></a>
<a class="sourceLine" id="cb2-31" data-line-number="31">gs0_result =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="dv">0</span>, B, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb2-32" data-line-number="32"></a>
<a class="sourceLine" id="cb2-33" data-line-number="33">beta_result =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="dv">0</span>, B, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb2-34" data-line-number="34"></a>
<a class="sourceLine" id="cb2-35" data-line-number="35">sig_result =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="ot">NA</span>, <span class="dt">dim=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2</span>,<span class="dv">2</span>,B))</a>
<a class="sourceLine" id="cb2-36" data-line-number="36"></a>
<a class="sourceLine" id="cb2-37" data-line-number="37"></a>
<a class="sourceLine" id="cb2-38" data-line-number="38"><span class="cf">for</span>(b <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>B){</a>
<a class="sourceLine" id="cb2-39" data-line-number="39">  </a>
<a class="sourceLine" id="cb2-40" data-line-number="40">  mname =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"model_"</span>,b)</a>
<a class="sourceLine" id="cb2-41" data-line-number="41">  </a>
<a class="sourceLine" id="cb2-42" data-line-number="42">  <span class="kw"><a href="https://rdrr.io/r/base/load.html">load</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(mname, <span class="st">".rda"</span>))</a>
<a class="sourceLine" id="cb2-43" data-line-number="43">  </a>
<a class="sourceLine" id="cb2-44" data-line-number="44">  d =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/get.html">get</a></span>(mname)</a>
<a class="sourceLine" id="cb2-45" data-line-number="45">  </a>
<a class="sourceLine" id="cb2-46" data-line-number="46">  a_result[i,] =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/apply.html">apply</a></span>(d<span class="op">$</span>as, <span class="dv">2</span>, <span class="dt">FUN =</span> mean)</a>
<a class="sourceLine" id="cb2-47" data-line-number="47">  b_result[i,] =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/apply.html">apply</a></span>(d<span class="op">$</span>bs, <span class="dv">2</span>, <span class="dt">FUN =</span> mean)</a>
<a class="sourceLine" id="cb2-48" data-line-number="48">  </a>
<a class="sourceLine" id="cb2-49" data-line-number="49">  gs0_result[i,] =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/apply.html">apply</a></span>(d<span class="op">$</span>gs0, <span class="dv">2</span>, <span class="dt">FUN =</span> mean)</a>
<a class="sourceLine" id="cb2-50" data-line-number="50">  </a>
<a class="sourceLine" id="cb2-51" data-line-number="51">  beta_result[i,] =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/apply.html">apply</a></span>(d<span class="op">$</span>betas, <span class="dv">2</span>, <span class="dt">FUN =</span> mean)</a>
<a class="sourceLine" id="cb2-52" data-line-number="52">  </a>
<a class="sourceLine" id="cb2-53" data-line-number="53">  sig_result[,,i] =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/solve.html">solve</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/apply.html">apply</a></span>(d<span class="op">$</span>Sigma_zeta_inv, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="dt">FUN =</span> mean))</a>
<a class="sourceLine" id="cb2-54" data-line-number="54">}</a>
<a class="sourceLine" id="cb2-55" data-line-number="55"></a>
<a class="sourceLine" id="cb2-56" data-line-number="56"><span class="co"># Obtain an overall mean for each of the following:</span></a>
<a class="sourceLine" id="cb2-57" data-line-number="57"></a>
<a class="sourceLine" id="cb2-58" data-line-number="58">m_a_result =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/apply.html">apply</a></span>(a_result, <span class="dv">2</span>, <span class="dt">FUN =</span> mean)</a>
<a class="sourceLine" id="cb2-59" data-line-number="59"></a>
<a class="sourceLine" id="cb2-60" data-line-number="60">m_b_result =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/apply.html">apply</a></span>(b_result, <span class="dv">2</span>, <span class="dt">FUN =</span> mean)</a>
<a class="sourceLine" id="cb2-61" data-line-number="61"></a>
<a class="sourceLine" id="cb2-62" data-line-number="62">m_gs0_result =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/apply.html">apply</a></span>(gs0_result, <span class="dv">2</span>, <span class="dt">FUN =</span> mean)</a>
<a class="sourceLine" id="cb2-63" data-line-number="63"></a>
<a class="sourceLine" id="cb2-64" data-line-number="64">m_beta_result =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/apply.html">apply</a></span>(beta_result, <span class="dv">2</span>, <span class="dt">FUN =</span> mean)</a>
<a class="sourceLine" id="cb2-65" data-line-number="65"></a>
<a class="sourceLine" id="cb2-66" data-line-number="66">m_sig_result =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/apply.html">apply</a></span>(sig_result, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="dt">FUN =</span> mean))[<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>)]</a>
<a class="sourceLine" id="cb2-67" data-line-number="67"></a>
<a class="sourceLine" id="cb2-68" data-line-number="68"></a>
<a class="sourceLine" id="cb2-69" data-line-number="69"><span class="co"># Perform a bias evaluation given the true values:</span></a>
<a class="sourceLine" id="cb2-70" data-line-number="70"></a>
<a class="sourceLine" id="cb2-71" data-line-number="71">a_bias =<span class="st"> </span><span class="kw">bias2</span>(m_a_result,atrue)</a>
<a class="sourceLine" id="cb2-72" data-line-number="72"></a>
<a class="sourceLine" id="cb2-73" data-line-number="73">b_bias =<span class="st"> </span><span class="kw">bias2</span>(m_b_result,btrue)</a>
<a class="sourceLine" id="cb2-74" data-line-number="74"></a>
<a class="sourceLine" id="cb2-75" data-line-number="75">gs0_bias =<span class="st"> </span><span class="kw">bias2</span>(m_gs0_result,gamma[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>])</a>
<a class="sourceLine" id="cb2-76" data-line-number="76"></a>
<a class="sourceLine" id="cb2-77" data-line-number="77">beta_bias =<span class="st"> </span><span class="kw">bias2</span>(m_beta_result,gamma[<span class="dv">3</span><span class="op">:</span><span class="dv">4</span>])</a>
<a class="sourceLine" id="cb2-78" data-line-number="78"></a>
<a class="sourceLine" id="cb2-79" data-line-number="79">sig_bias =<span class="st"> </span><span class="kw">bias2</span>(m_sig_result, Sig)</a>
<a class="sourceLine" id="cb2-80" data-line-number="80"></a>
<a class="sourceLine" id="cb2-81" data-line-number="81"><span class="co"># Perform the RMSE under the supplied results:</span></a>
<a class="sourceLine" id="cb2-82" data-line-number="82"></a>
<a class="sourceLine" id="cb2-83" data-line-number="83">a_RMSE =<span class="st"> </span><span class="kw">RMSE</span>(m_a_result,atrue)</a>
<a class="sourceLine" id="cb2-84" data-line-number="84"></a>
<a class="sourceLine" id="cb2-85" data-line-number="85">b_RMSE =<span class="st"> </span><span class="kw">RMSE</span>(m_b_result,btrue)</a>
<a class="sourceLine" id="cb2-86" data-line-number="86"></a>
<a class="sourceLine" id="cb2-87" data-line-number="87">gs0_RMSE =<span class="st"> </span><span class="kw">RMSE</span>(m_gs0_result,gamma[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>])</a>
<a class="sourceLine" id="cb2-88" data-line-number="88"></a>
<a class="sourceLine" id="cb2-89" data-line-number="89">beta_RMSE =<span class="st"> </span><span class="kw">RMSE</span>(m_beta_result,gamma[<span class="dv">3</span><span class="op">:</span><span class="dv">4</span>])</a>
<a class="sourceLine" id="cb2-90" data-line-number="90"></a>
<a class="sourceLine" id="cb2-91" data-line-number="91">sig_RMSE =<span class="st"> </span><span class="kw">RMSE</span>(m_sig_result, Sig)</a></code></pre></div>
</div>
<div id="exporting-results-for-publication" class="section level1">
<h1 class="hasAnchor">
<a href="#exporting-results-for-publication" class="anchor"></a>Exporting Results for Publication</h1>
<p>After we obtain the different results, we opted to write export code to format the data in a way that the <code>xtable</code> could process and export it.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="co"># Make a results export</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2">results_a =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(m_a_result, atrue, a_bias, a_RMSE)</a>
<a class="sourceLine" id="cb3-3" data-line-number="3"></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(results_a) =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"Item "</span>,<span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(atrue))</a>
<a class="sourceLine" id="cb3-5" data-line-number="5"></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(results_a) =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"$a$ Estimate"</span>, <span class="st">"$a$ True"</span>, <span class="st">"$a$ Bias"</span>, <span class="st">"$a$ RMSE"</span>)</a>
<a class="sourceLine" id="cb3-7" data-line-number="7"></a>
<a class="sourceLine" id="cb3-8" data-line-number="8">results_b =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(m_b_result,  btrue, b_bias, b_RMSE)</a>
<a class="sourceLine" id="cb3-9" data-line-number="9"></a>
<a class="sourceLine" id="cb3-10" data-line-number="10"><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(results_b) =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"Item "</span>,<span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(btrue))</a>
<a class="sourceLine" id="cb3-11" data-line-number="11"><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(results_b) =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"$b$ Estimate"</span>, <span class="st">"$b$ True"</span>, <span class="st">"$b$ Bias"</span>, <span class="st">"$b$ RMSE"</span>)</a>
<a class="sourceLine" id="cb3-12" data-line-number="12">  </a>
<a class="sourceLine" id="cb3-13" data-line-number="13">results_gs0 =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(m_gs0_result,gamma[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],gs0_bias,gs0_RMSE)</a>
<a class="sourceLine" id="cb3-14" data-line-number="14"><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(results_gs0) =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"$</span><span class="ch">\\</span><span class="st">gamma_"</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,<span class="st">"$"</span>)</a>
<a class="sourceLine" id="cb3-15" data-line-number="15"><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(results_gs0) =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"$</span><span class="ch">\\</span><span class="st">beta$ Estimate"</span>, <span class="st">"$</span><span class="ch">\\</span><span class="st">beta$ True"</span>, <span class="st">"$</span><span class="ch">\\</span><span class="st">beta$ Bias"</span>, <span class="st">"$</span><span class="ch">\\</span><span class="st">beta$ RMSE"</span>)</a>
<a class="sourceLine" id="cb3-16" data-line-number="16"></a>
<a class="sourceLine" id="cb3-17" data-line-number="17">results_beta =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(m_beta_result,gamma[<span class="dv">3</span><span class="op">:</span><span class="dv">4</span>],beta_bias,beta_RMSE)</a>
<a class="sourceLine" id="cb3-18" data-line-number="18"><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(results_beta) =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"$</span><span class="ch">\\</span><span class="st">beta_"</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,<span class="st">"$"</span>)</a>
<a class="sourceLine" id="cb3-19" data-line-number="19"><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(results_beta) =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"$</span><span class="ch">\\</span><span class="st">beta$ Estimate"</span>, <span class="st">"$</span><span class="ch">\\</span><span class="st">beta$ True"</span>, <span class="st">"$</span><span class="ch">\\</span><span class="st">beta$ Bias"</span>, <span class="st">"$</span><span class="ch">\\</span><span class="st">beta$ RMSE"</span>)</a>
<a class="sourceLine" id="cb3-20" data-line-number="20"></a>
<a class="sourceLine" id="cb3-21" data-line-number="21">results_sig_zeta =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(m_sig_result,Sig,sig_bias,sig_RMSE)</a>
<a class="sourceLine" id="cb3-22" data-line-number="22"><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(results_sig_zeta) =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"$</span><span class="ch">\\</span><span class="st">Zeta_{1,1}$"</span>,<span class="st">"$</span><span class="ch">\\</span><span class="st">Zeta_{2,1} = $</span><span class="ch">\\</span><span class="st">Zeta_{1,2}$"</span>, <span class="st">"$</span><span class="ch">\\</span><span class="st">Zeta_{2,2}$"</span>)</a>
<a class="sourceLine" id="cb3-23" data-line-number="23"><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(results_sig_zeta) =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"$</span><span class="ch">\\</span><span class="st">Sigma_{</span><span class="ch">\\</span><span class="st">Zeta}$ Estimate"</span>, <span class="st">"$</span><span class="ch">\\</span><span class="st">beta$ True"</span>, <span class="st">"$</span><span class="ch">\\</span><span class="st">beta$ Bias"</span>, <span class="st">"$</span><span class="ch">\\</span><span class="st">beta$ RMSE"</span>)</a>
<a class="sourceLine" id="cb3-24" data-line-number="24"></a>
<a class="sourceLine" id="cb3-25" data-line-number="25"><span class="kw"><a href="https://rdrr.io/r/base/save.html">save</a></span>(results_a, results_b, results_gs0, results_beta, results_sig_zeta, <span class="dt">file=</span><span class="st">"sim_results.rda"</span>)</a></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#intro">Intro</a></li>
      <li><a href="#simulation">Simulation</a></li>
      <li><a href="#simulation-results">Simulation Results</a></li>
      <li><a href="#exporting-results-for-publication">Exporting Results for Publication</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Steven Andrew Culpepper, James Joseph Balamuta.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>

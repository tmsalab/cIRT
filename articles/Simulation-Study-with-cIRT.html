<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Simulation Study with cIRT • cIRT</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Simulation Study with cIRT">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-151562227-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-151562227-1');
</script>
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cIRT</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.3.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Estimating-the-Model-in-the-Paper.html">Estimating the Model in the Paper</a>
    </li>
    <li>
      <a href="../articles/Package-Overview.html">Package Overview</a>
    </li>
    <li>
      <a href="../articles/Simulation-Study-with-cIRT.html">Simulation Study with cIRT</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/tmsalab/cIRT/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Simulation Study with cIRT</h1>
            
            <h4 data-toc-skip class="date">2025-09-27</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/tmsalab/cIRT/blob/master/vignettes/Simulation-Study-with-cIRT.Rmd" class="external-link"><code>vignettes/Simulation-Study-with-cIRT.Rmd</code></a></small>
      <div class="hidden name"><code>Simulation-Study-with-cIRT.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="intro">Intro<a class="anchor" aria-label="anchor" href="#intro"></a>
</h2>
<p>The document addresses the simulation study that was performed to
understand whether <code>cIRT</code> was able to effectively recover
parameters under the proposed model. There are three sections to this
document. The first section details the simulation setup and
implementation. The second section deals with how we obtained overall
measurements for each model realization. The third and final section
depicts the output structure we used to create the tables within the
publication.</p>
</div>
<div class="section level2">
<h2 id="simulation">Simulation<a class="anchor" aria-label="anchor" href="#simulation"></a>
</h2>
<p>The simulation study below is configured to generate results one
might obtain from a pool of 1,000 subjects taking a 20 item test. We
obtain summarize the results obtained from running the model 100 times
over slightly differing
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>η</mi><annotation encoding="application/x-tex">\eta</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### Variables</span></span>
<span><span class="co"># Y = trial matix</span></span>
<span><span class="co"># C = KN vector of binary choices</span></span>
<span><span class="co"># N = #of subjects</span></span>
<span><span class="co"># J = # of items</span></span>
<span><span class="co"># K = # of choices</span></span>
<span><span class="co"># atrue = true item discriminations</span></span>
<span><span class="co"># btrue = true item locations</span></span>
<span><span class="co"># thetatrue = true thetas/latent performance</span></span>
<span><span class="co"># gamma = fixed effects coefficients</span></span>
<span><span class="co"># Sig = random-effects variance-covariance</span></span>
<span><span class="co"># subid = id variable for subjects</span></span>
<span></span>
<span><span class="co"># install mvtnorm is necessary</span></span>
<span><span class="co"># install.packages("mvtnorm")</span></span>
<span></span>
<span><span class="co"># Load the Library</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tmsalab.github.io/cIRT/" class="external-link">cIRT</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Simulate 2PNO Data</span></span>
<span><span class="va">N</span> <span class="op">=</span> <span class="fl">1000</span>  <span class="co"># Students</span></span>
<span><span class="va">J</span> <span class="op">=</span> <span class="fl">20</span>    <span class="co"># Total numbers of possible items per SA</span></span>
<span></span>
<span><span class="co"># Set a seed for the random generation of a's and b's.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1337</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Randomly pick a's and b's</span></span>
<span></span>
<span><span class="co"># Generate as, bs</span></span>
<span><span class="va">atrue</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">J</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span></span>
<span><span class="va">btrue</span><span class="op">=</span><span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">J</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/save.html" class="external-link">save</a></span><span class="op">(</span><span class="va">atrue</span>, <span class="va">btrue</span>, file<span class="op">=</span><span class="st">"a_b_true.rda"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># 2 Level Probit Data</span></span>
<span><span class="va">K</span> <span class="op">=</span> <span class="fl">30</span></span>
<span></span>
<span><span class="va">gam_notheta</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.5</span>,<span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">gam_theta</span>   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">.25</span><span class="op">)</span></span>
<span><span class="va">gamma</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">gam_notheta</span>,<span class="va">gam_theta</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Sig</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.25</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">.125</span><span class="op">)</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Number of replications</span></span>
<span><span class="va">B</span> <span class="op">=</span> <span class="fl">100</span></span>
<span></span>
<span><span class="co"># Begin the Simulation Study</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">b</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">B</span><span class="op">)</span><span class="op">{</span></span>
<span>  </span>
<span>  <span class="co"># Provide user with state information</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"On Iteration:"</span>,<span class="va">b</span>,<span class="st">"\n"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="va">b</span> <span class="op">+</span> <span class="fl">1234</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># True theta and etay</span></span>
<span>  <span class="va">thetatrue</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span></span>
<span>  <span class="va">etay</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/outer.html" class="external-link">outer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">N</span><span class="op">)</span>,<span class="va">atrue</span><span class="op">)</span> <span class="op">*</span> <span class="va">thetatrue</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/outer.html" class="external-link">outer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">N</span><span class="op">)</span>,<span class="va">btrue</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Generate Y for 2PNO model</span></span>
<span>  <span class="va">p.correct</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">pnorm</a></span><span class="op">(</span><span class="va">etay</span><span class="op">)</span></span>
<span>  <span class="va">Y</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">N</span><span class="op">*</span><span class="va">J</span>, <span class="fl">1</span>, <span class="va">p.correct</span><span class="op">)</span>,<span class="va">N</span>,<span class="va">J</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co">#################################################</span></span>
<span>  <span class="co"># Simulating 2 level probit data</span></span>
<span>  <span class="co">#################################################</span></span>
<span>  </span>
<span>  <span class="va">subid</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>cid <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">K</span>,sid <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">N</span><span class="op">)</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="va">pred</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">K</span><span class="op">*</span><span class="va">N</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span> <span class="co"># Pred</span></span>
<span>  </span>
<span>  <span class="va">center_pred</span> <span class="op">=</span> <span class="fu"><a href="../reference/center_matrix.html">center_matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">pred</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">Xnotheta</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">center_pred</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">Xtheta</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">thetatrue</span>,each<span class="op">=</span><span class="va">K</span><span class="op">)</span><span class="op">*</span><span class="va">Xnotheta</span></span>
<span>  <span class="va">X</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">Xnotheta</span>,<span class="va">Xtheta</span><span class="op">)</span></span>
<span>  </span>
<span>  </span>
<span>  <span class="va">zetas</span> <span class="op">=</span> <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu">rmvnorm</span><span class="op">(</span><span class="va">N</span>,mean<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>,sigma<span class="op">=</span><span class="va">Sig</span><span class="op">)</span> <span class="co"># mvtnorm environment accessed</span></span>
<span>  <span class="va">W_veczeta</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">Xnotheta</span><span class="op">*</span><span class="va">zetas</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">N</span>,each<span class="op">=</span><span class="va">K</span><span class="op">)</span>,<span class="op">]</span>,<span class="fl">1</span>,<span class="va">sum</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">etac</span> <span class="op">=</span> <span class="va">X</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="va">gamma</span> <span class="op">+</span> <span class="va">W_veczeta</span></span>
<span>  <span class="va">Zc</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">N</span><span class="op">*</span><span class="va">K</span>,mean<span class="op">=</span><span class="va">etac</span>,sd<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">C</span> <span class="op">=</span> <span class="fl">1</span><span class="op">*</span><span class="op">(</span><span class="va">Zc</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Run the Choice Item Response Model</span></span>
<span>  <span class="va">out1</span> <span class="op">=</span> <span class="fu"><a href="../reference/cIRT.html">cIRT</a></span><span class="op">(</span><span class="va">subid</span>, </span>
<span>              <span class="va">Xnotheta</span>,</span>
<span>              <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, </span>
<span>              <span class="va">Xnotheta</span>,</span>
<span>              <span class="va">Y</span>, </span>
<span>              <span class="va">C</span>, </span>
<span>              <span class="fl">5000</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">mname</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"model_"</span>,<span class="va">b</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Assign the data set name</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/assign.html" class="external-link">assign</a></span><span class="op">(</span><span class="va">mname</span>, <span class="va">out1</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Save the out object</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/save.html" class="external-link">save</a></span><span class="op">(</span>list<span class="op">=</span><span class="va">mname</span>, file<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">mname</span>,<span class="st">".rda"</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Clean up Export</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">mname</span>,<span class="st">"out1"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="simulation-results">Simulation Results<a class="anchor" aria-label="anchor" href="#simulation-results"></a>
</h2>
<p>After we obtain the 100 different models, we will need to take
averages over each models chain and then obtain an overall average. To
do so, we used the following script:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># E[theta] - theta </span></span>
<span><span class="va">bias</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">theta.star</span>, <span class="va">theta.true</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">theta.star</span><span class="op">)</span> <span class="op">-</span> <span class="va">theta.true</span>,ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">bias2</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">theta.star</span>, <span class="va">theta.true</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">theta.star</span> <span class="op">-</span> <span class="va">theta.true</span>,ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># sqrt ( 1/n * sum( (y_i - y.hat_i)^2 )</span></span>
<span><span class="va">RMSE</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">y</span>,<span class="va">y.hat</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span>  <span class="op">(</span><span class="va">y</span><span class="op">-</span><span class="va">y.hat</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">)</span> </span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Change true values if needed</span></span>
<span><span class="co"># True Values</span></span>
<span><span class="va">gam_notheta</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.5</span>,<span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">gam_theta</span>   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">.25</span><span class="op">)</span></span>
<span><span class="va">gamma</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">gam_notheta</span>,<span class="va">gam_theta</span><span class="op">)</span></span>
<span><span class="co"># Loads a and b values</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="st">"a_b_true.rda"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Sig</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.25</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">.125</span><span class="op">)</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">B</span> <span class="op">=</span> <span class="fl">100</span></span>
<span></span>
<span><span class="co"># Storage to hold bootstrap replications</span></span>
<span><span class="va">a_result</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">B</span>, <span class="fl">20</span><span class="op">)</span></span>
<span></span>
<span><span class="va">b_result</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">B</span>, <span class="fl">20</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gs0_result</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">B</span>, <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">beta_result</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">B</span>, <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sig_result</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="cn">NA</span>, dim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span>,<span class="va">B</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">b</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">B</span><span class="op">)</span><span class="op">{</span></span>
<span>  </span>
<span>  <span class="va">mname</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"model_"</span>,<span class="va">b</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">mname</span>, <span class="st">".rda"</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">d</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/get.html" class="external-link">get</a></span><span class="op">(</span><span class="va">mname</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">a_result</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">as</span>, <span class="fl">2</span>, FUN <span class="op">=</span> <span class="va">mean</span><span class="op">)</span></span>
<span>  <span class="va">b_result</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">bs</span>, <span class="fl">2</span>, FUN <span class="op">=</span> <span class="va">mean</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">gs0_result</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">gs0</span>, <span class="fl">2</span>, FUN <span class="op">=</span> <span class="va">mean</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">beta_result</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">betas</span>, <span class="fl">2</span>, FUN <span class="op">=</span> <span class="va">mean</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">sig_result</span><span class="op">[</span>,,<span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">Sigma_zeta_inv</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, FUN <span class="op">=</span> <span class="va">mean</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Obtain an overall mean for each of the following:</span></span>
<span></span>
<span><span class="va">m_a_result</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">a_result</span>, <span class="fl">2</span>, FUN <span class="op">=</span> <span class="va">mean</span><span class="op">)</span></span>
<span></span>
<span><span class="va">m_b_result</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">b_result</span>, <span class="fl">2</span>, FUN <span class="op">=</span> <span class="va">mean</span><span class="op">)</span></span>
<span></span>
<span><span class="va">m_gs0_result</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">gs0_result</span>, <span class="fl">2</span>, FUN <span class="op">=</span> <span class="va">mean</span><span class="op">)</span></span>
<span></span>
<span><span class="va">m_beta_result</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">beta_result</span>, <span class="fl">2</span>, FUN <span class="op">=</span> <span class="va">mean</span><span class="op">)</span></span>
<span></span>
<span><span class="va">m_sig_result</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">sig_result</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, FUN <span class="op">=</span> <span class="va">mean</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span></span>
<span><span class="co"># Perform a bias evaluation given the true values:</span></span>
<span></span>
<span><span class="va">a_bias</span> <span class="op">=</span> <span class="fu">bias2</span><span class="op">(</span><span class="va">m_a_result</span>,<span class="va">atrue</span><span class="op">)</span></span>
<span></span>
<span><span class="va">b_bias</span> <span class="op">=</span> <span class="fu">bias2</span><span class="op">(</span><span class="va">m_b_result</span>,<span class="va">btrue</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gs0_bias</span> <span class="op">=</span> <span class="fu">bias2</span><span class="op">(</span><span class="va">m_gs0_result</span>,<span class="va">gamma</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">beta_bias</span> <span class="op">=</span> <span class="fu">bias2</span><span class="op">(</span><span class="va">m_beta_result</span>,<span class="va">gamma</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sig_bias</span> <span class="op">=</span> <span class="fu">bias2</span><span class="op">(</span><span class="va">m_sig_result</span>, <span class="va">Sig</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform the RMSE under the supplied results:</span></span>
<span></span>
<span><span class="va">a_RMSE</span> <span class="op">=</span> <span class="fu">RMSE</span><span class="op">(</span><span class="va">m_a_result</span>,<span class="va">atrue</span><span class="op">)</span></span>
<span></span>
<span><span class="va">b_RMSE</span> <span class="op">=</span> <span class="fu">RMSE</span><span class="op">(</span><span class="va">m_b_result</span>,<span class="va">btrue</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gs0_RMSE</span> <span class="op">=</span> <span class="fu">RMSE</span><span class="op">(</span><span class="va">m_gs0_result</span>,<span class="va">gamma</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">beta_RMSE</span> <span class="op">=</span> <span class="fu">RMSE</span><span class="op">(</span><span class="va">m_beta_result</span>,<span class="va">gamma</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sig_RMSE</span> <span class="op">=</span> <span class="fu">RMSE</span><span class="op">(</span><span class="va">m_sig_result</span>, <span class="va">Sig</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="exporting-results-for-publication">Exporting Results for Publication<a class="anchor" aria-label="anchor" href="#exporting-results-for-publication"></a>
</h2>
<p>After we obtain the different results, we opted to write export code
to format the data in a way that the <code>xtable</code> could process
and export it.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Make a results export</span></span>
<span><span class="va">results_a</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">m_a_result</span>, <span class="va">atrue</span>, <span class="va">a_bias</span>, <span class="va">a_RMSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">results_a</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Item "</span>,<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">atrue</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">results_a</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"$a$ Estimate"</span>, <span class="st">"$a$ True"</span>, <span class="st">"$a$ Bias"</span>, <span class="st">"$a$ RMSE"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">results_b</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">m_b_result</span>,  <span class="va">btrue</span>, <span class="va">b_bias</span>, <span class="va">b_RMSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">results_b</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Item "</span>,<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">btrue</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">results_b</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"$b$ Estimate"</span>, <span class="st">"$b$ True"</span>, <span class="st">"$b$ Bias"</span>, <span class="st">"$b$ RMSE"</span><span class="op">)</span></span>
<span>  </span>
<span><span class="va">results_gs0</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">m_gs0_result</span>,<span class="va">gamma</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>,<span class="va">gs0_bias</span>,<span class="va">gs0_RMSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">results_gs0</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"$\\gamma_"</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="st">"$"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">results_gs0</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"$\\beta$ Estimate"</span>, <span class="st">"$\\beta$ True"</span>, <span class="st">"$\\beta$ Bias"</span>, <span class="st">"$\\beta$ RMSE"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">results_beta</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">m_beta_result</span>,<span class="va">gamma</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>,<span class="va">beta_bias</span>,<span class="va">beta_RMSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">results_beta</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"$\\beta_"</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="st">"$"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">results_beta</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"$\\beta$ Estimate"</span>, <span class="st">"$\\beta$ True"</span>, <span class="st">"$\\beta$ Bias"</span>, <span class="st">"$\\beta$ RMSE"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">results_sig_zeta</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">m_sig_result</span>,<span class="va">Sig</span>,<span class="va">sig_bias</span>,<span class="va">sig_RMSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">results_sig_zeta</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"$\\Zeta_{1,1}$"</span>,<span class="st">"$\\Zeta_{2,1} = $\\Zeta_{1,2}$"</span>, <span class="st">"$\\Zeta_{2,2}$"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">results_sig_zeta</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"$\\Sigma_{\\Zeta}$ Estimate"</span>, <span class="st">"$\\beta$ True"</span>, <span class="st">"$\\beta$ Bias"</span>, <span class="st">"$\\beta$ RMSE"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/save.html" class="external-link">save</a></span><span class="op">(</span><span class="va">results_a</span>, <span class="va">results_b</span>, <span class="va">results_gs0</span>, <span class="va">results_beta</span>, <span class="va">results_sig_zeta</span>, file<span class="op">=</span><span class="st">"sim_results.rda"</span><span class="op">)</span></span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Steven Andrew Culpepper, James Joseph Balamuta.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer>
</div>






  </body>
</html>
